<div class="modal-header" style="padding: 15px">
    <button type="button" class="close" data-dismiss="modal">
        <span aria-hidden="true" style="font-size: 30px;">&times;</span>
        <span class="sr-only">Close</span>
    </button>
    <h6 class="modal-title">项目弹性时间设置</h6>
</div>
<div class="modal-body">
    <div class="row">
        <div class="col-lg-12">
            <div class="ibox">
                <div class="ibox-content">
                    <div class="form-horizontal">
                        <div class="form-group">
                            <label class="col-sm-2 control-label">
                                项目名称
                            </label>

                            <div class="col-sm-10 control-label" style="text-align: left">
                                <span id="f_project_name"></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">弹性时间（月）</label>
                            <div class="col-sm-10">
                                <input class="form-control" id="f_flex_time" type="text" value="">
                            </div>
                        </div>
                        <!-- <div class="form-group">
                            <label class="col-sm-2 control-label">说明</label>
                            <div class="col-sm-10">
                                <span id="text"></span>
                            </div>
                        </div> -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal-footer">
    <button type="button" class="btn btn-white" data-dismiss="modal">返回</button>
    <button type="button" class="btn btn-primary" onclick="set_project_flex()">设置</button>
</div>
<script>
    $(function () {
        if (app.win_url.indexOf("?key=") > 0) {
            app.win_key = decodeURIComponent(app.win_url.split("?key=")[1]);
        }
        var options = {
            url: 'FindProjectWithKey',
            data: {
                ProjectName: app.win_key,
            },
            callback: function (res, param) {
                res = eval("(" + res + ")");
                if (res.code == 10000) {
                    if (res.data == null) {
                        return;
                    }
                    $("#f_project_name").html(res.data.Name);
                    $("#f_flex_time").val(res.data.FlexMonth);
                } else {
                    app.error(res.msg);
                }
            },
            callback_params: {}
        };

        app.execPostRequest(options);
    });

    function set_project_flex() {
        var month = $("#f_flex_time").val();

        var options = {
            url: 'SetFlexProjectTime',
            data: {
                ProjectName: app.win_key,
                Month: parseInt(month),
            },
            callback: app.saveCallbackWindow,
            callback_params: {
                action: "edit",
                refresh: project_refresh,
                key: app.win_key,
            }
        };
        app.execPostRequest(options);
    }
</script>